<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<div class="chat-container">
  <app-sidebar></app-sidebar>
  <main class="main-center-content">
    <div class="centered-content">
      <!-- 1. Mini Perfil -->
      <section class="mini-perfil card">
        <div class="avatar-container">
          <img class="avatar-img" src="assets/avatar-default.png" alt="Avatar" />
        </div>
        <div class="perfil-info">
          <h2>Mi Perfil</h2>
          <div class="perfil-datos">
            <div><strong>Nombre:</strong> {{ usuario.nombre || 'Nombre Usuario' }}</div>
            <div><strong>Edad:</strong> {{ usuario.edad || '--' }}</div>
            <div><strong>Objetivo en turno:</strong> {{ usuario.objetivo || 'Sin objetivo asignado' }}</div>
          </div>
        </div>
      </section>

      <!-- 2. Resumen Semanal -->
      <section class="resumen-semanal card">
        <h2>Resumen Semanal</h2>
        <button [disabled]="!tieneResumenSemanal" class="btn-resumen">
          Ver Resumen Semanal
        </button>
        <button *ngIf="!tieneResumenSemanal" class="btn-generar">
          Generar Resumen
        </button>
        <!-- Aquí irá la funcionalidad de resumen semanal -->
      </section>

      <!-- 3. Citas -->
      <section class="citas card">
        <h2>Citas</h2>
        <ng-container *ngIf="citaEnTurno; else sinCita">
          <div class="cita-info">
            <div><strong>Fecha:</strong> {{ citaEnTurno.fecha }}</div>
            <div><strong>Hora:</strong> {{ citaEnTurno.hora }}</div>
            <div><strong>Motivo:</strong> {{ citaEnTurno.motivo }}</div>
            <!-- Agrega más campos según sea necesario -->
          </div>
        </ng-container>
        <ng-template #sinCita>
          <button class="btn-agendar" (click)="abrirModalCita()">Agendar Cita</button>
        </ng-template>
        <!-- Aquí irá el modal de agendar cita -->
      </section>

      <!-- Apartado para el test Big Five -->
      <section class="bigfive-manual card">
        <h2>Test de Personalidad Big Five</h2>
        <button class="btn-bigfive" (click)="irAPerfilPsicometrico()">Ver mi resultado Big Five</button>
        <button class="btn-bigfive" (click)="irABigFiveTest()">Realizar el test Big Five</button>
      </section>
    </div>
  </main>
</div>

<!-- Botón flotante para abrir el chat -->
<div class="chat-fab" (click)="openChat()">
  <i class="fa-solid fa-robot"></i>
</div>

<!-- Modal general del chatbot -->
<app-chatbot-modal
  [show]="showChatModal"
  [messages]="messages"
  [userInput]="userInput"
  [loading]="loading">
</app-chatbot-modal>